

<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>quantificationlib.multiclass.knn module &#8212; quantificationlib 0.1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="quantificationlib.multiclass.regression module" href="quantificationlib.multiclass.regression.html" />
    <link rel="prev" title="quantificationlib.multiclass.friedman module" href="quantificationlib.multiclass.friedman.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="quantificationlib.multiclass.regression.html" title="quantificationlib.multiclass.regression module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="quantificationlib.multiclass.friedman.html" title="quantificationlib.multiclass.friedman module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">quantificationlib 0.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="quantificationlib.multiclass.html" accesskey="U">quantificationlib.multiclass package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">quantificationlib.multiclass.knn module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-quantificationlib.multiclass.knn">
<span id="quantificationlib-multiclass-knn-module"></span><h1>quantificationlib.multiclass.knn module<a class="headerlink" href="#module-quantificationlib.multiclass.knn" title="Permalink to this heading">¶</a></h1>
<p>PWKQuantifier a quantifier based on K-Nearest Neighbor</p>
<dl class="py class">
<dt class="sig sig-object py" id="quantificationlib.multiclass.knn.PWKQuantifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PWKQuantifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minkowski'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/quantificationlib/multiclass/knn.html#PWKQuantifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quantificationlib.multiclass.knn.PWKQuantifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="quantificationlib.base.html#quantificationlib.base.WithoutClassifiers" title="quantificationlib.base.WithoutClassifiers"><code class="xref py py-class docutils literal notranslate"><span class="pre">WithoutClassifiers</span></code></a></p>
<p>Quantifier based on K-Nearest Neighbor proposed by (Barranquero et al., 2013)</p>
<p>It is a AC method in which the estimator is PWK, a weighted version of KNN in
which the weight depends on the proportion of each class in the training set. It is not derived from AC to
allow decomposition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_neighbors</strong> (<em>int</em><em>, </em><em>(</em><em>default=10</em><em>)</em>) – Number of neighbors to use by default for <code class="xref py py-meth docutils literal notranslate"><span class="pre">kneighbors()</span></code> queries.</p></li>
<li><p><strong>p</strong> (<em>int</em><em>, </em><em>default=2</em>) – Power parameter for the Minkowski metric. When p = 1, this is
equivalent to using manhattan_distance (l1), and euclidean_distance
(l2) for p = 2. For arbitrary p, minkowski_distance (l_p) is used.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em> or </em><em>callable</em><em>, </em><em>default='minkowski'</em>) – The distance metric to use for the tree.  The default metric is
minkowski, and with p=2 is equivalent to the standard Euclidean
metric. For a list of available metrics, see the documentation of
<code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceMetric</span></code>.
If metric is “precomputed”, X is assumed to be a distance matrix and
must be square during fit. X may be a <span class="xref std std-term">sparse graph</span>,
in which case only “nonzero” elements may be considered neighbors.</p></li>
<li><p><strong>metric_params</strong> (<em>dict</em><em>, </em><em>default=None</em>) – Additional keyword arguments for the metric function.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>(</em><em>default=0</em><em>)</em>) – The verbosity level. The default value, zero, means silent mode</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="quantificationlib.multiclass.knn.PWKQuantifier.classes_">
<span class="sig-name descname"><span class="pre">classes_</span></span><a class="headerlink" href="#quantificationlib.multiclass.knn.PWKQuantifier.classes_" title="Permalink to this definition">¶</a></dt>
<dd><p>Class labels</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_classes, )</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="quantificationlib.multiclass.knn.PWKQuantifier.cm_">
<span class="sig-name descname"><span class="pre">cm_</span></span><a class="headerlink" href="#quantificationlib.multiclass.knn.PWKQuantifier.cm_" title="Permalink to this definition">¶</a></dt>
<dd><p>Confusion matrix. The true classes are in the rows and the predicted classes in the columns. So, for
the binary case, the count of true negatives is cm_[0,0], false negatives is cm_[1,0],
true positives is cm_[1,1] and false positives is cm_[0,1] .</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_classes, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="quantificationlib.multiclass.knn.PWKQuantifier.problem_">
<span class="sig-name descname"><span class="pre">problem_</span></span><a class="headerlink" href="#quantificationlib.multiclass.knn.PWKQuantifier.problem_" title="Permalink to this definition">¶</a></dt>
<dd><p>This attribute is set to None in the fit() method. With such model, the first time a testing bag is
predicted this attribute will contain the corresponding cvxpy Object (if such library is used, i.e in the
case of ‘L1’ and ‘HD’). For the rest testing bags, this object is passed to allow a warm start. The
solving process is faster.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a cvxpy Problem object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="quantificationlib.multiclass.knn.PWKQuantifier.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#quantificationlib.multiclass.knn.PWKQuantifier.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>The verbosity level</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">References</p>
<p>Jose Barranquero, Pablo González, Jorge Díez, Juna José del Coz: On the study of nearest neighbor algorithms
for prevalence estimation in binary problems. Pattern Recognition, 46(2), 472-482. 2013</p>
<dl class="py method">
<dt class="sig sig-object py" id="quantificationlib.multiclass.knn.PWKQuantifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/quantificationlib/multiclass/knn.html#PWKQuantifier.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quantificationlib.multiclass.knn.PWKQuantifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>This method performs the following operations: 1) fits the estimators for the training set and the
testing set (if needed), and 2) computes <a href="#id1"><span class="problematic" id="id2">predictions_train_</span></a> (crisp values) if needed. Both operations are
performed by the <cite>fit</cite> method of its superclass.
Finally the method computes the confusion matrix of the training set using <a href="#id3"><span class="problematic" id="id4">predictions_train_</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_examples</em><em>, </em><em>n_features</em><em>)</em>) – Data</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_examples</em><em>, </em><em>)</em>) – True classes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quantificationlib.multiclass.knn.PWKQuantifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/quantificationlib/multiclass/knn.html#PWKQuantifier.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quantificationlib.multiclass.knn.PWKQuantifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the class distribution of a testing bag</p>
<p>The prevalences are computed solving a system of linear scalar equations:</p>
<blockquote>
<div><p><a href="#id5"><span class="problematic" id="id6">cm_</span></a>.T * prevalences = CC(X)</p>
</div></blockquote>
<p>For binary problems the system is directly solved using the original AC algorithm proposed by Forman</p>
<blockquote>
<div><p>p = (p_0 - fpr ) / ( tpr - fpr)</p>
</div></blockquote>
<p>For multiclass problems, the system may not have a solution. Thus, instead we propose to solve an
optimization problem of this kind:</p>
<blockquote>
<div><p>Min   distance ( <a href="#id7"><span class="problematic" id="id8">cm_</span></a>.T * prevalences, CC(X) )
s.t.  sum(prevalences) = 1</p>
<blockquote>
<div><p>prevalecences_i &gt;= 0</p>
</div></blockquote>
</div></blockquote>
<p>in which distance is ‘L1’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_examples</em><em>, </em><em>n_features</em><em>)</em>) – Testing bag</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>prevalences</strong> – Contains the predicted prevalence for each class</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape(n_classes, )</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">





<h3><a href="../index.html">Table of Contents</a></h3>
<ul>
<li><a class="reference internal" href="#">quantificationlib.multiclass.knn module</a><ul>
<li><a class="reference internal" href="#quantificationlib.multiclass.knn.PWKQuantifier"><code class="docutils literal notranslate"><span class="pre">PWKQuantifier</span></code></a><ul>
<li><a class="reference internal" href="#quantificationlib.multiclass.knn.PWKQuantifier.classes_"><code class="docutils literal notranslate"><span class="pre">classes_</span></code></a></li>
<li><a class="reference internal" href="#quantificationlib.multiclass.knn.PWKQuantifier.cm_"><code class="docutils literal notranslate"><span class="pre">cm_</span></code></a></li>
<li><a class="reference internal" href="#quantificationlib.multiclass.knn.PWKQuantifier.problem_"><code class="docutils literal notranslate"><span class="pre">problem_</span></code></a></li>
<li><a class="reference internal" href="#quantificationlib.multiclass.knn.PWKQuantifier.verbose"><code class="docutils literal notranslate"><span class="pre">verbose</span></code></a></li>
<li><a class="reference internal" href="#quantificationlib.multiclass.knn.PWKQuantifier.fit"><code class="docutils literal notranslate"><span class="pre">fit()</span></code></a></li>
<li><a class="reference internal" href="#quantificationlib.multiclass.knn.PWKQuantifier.predict"><code class="docutils literal notranslate"><span class="pre">predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>



<h3> Source Code </h3>
<a href="https://github.com/AICGijon/quantificationlib">GitHub Repository</a>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="quantificationlib.multiclass.friedman.html"
                          title="previous chapter">quantificationlib.multiclass.friedman module</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="quantificationlib.multiclass.regression.html"
                          title="next chapter">quantificationlib.multiclass.regression module</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="quantificationlib.multiclass.regression.html" title="quantificationlib.multiclass.regression module"
             >next</a> |</li>
        <li class="right" >
          <a href="quantificationlib.multiclass.friedman.html" title="quantificationlib.multiclass.friedman module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">quantificationlib 0.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="quantificationlib.multiclass.html" >quantificationlib.multiclass package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">quantificationlib.multiclass.knn module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, AIC Gijón.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.1.
    </div>
  </body>
</html>
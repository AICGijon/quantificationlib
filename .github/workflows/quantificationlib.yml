name: CI for quantificationlib
on:
  push:
    branches: [ main ]

jobs:
  tests:
    runs-on: ubuntu-20.04
    steps:
    - uses: checkout@v4
    - name: Setup Python
      uses: actions/setup-python@master
      with:
        python-version: 3.10
    - name: Generate Report
      run: |
        pip install coverage
        coverage run -m pytest
    - name: Upload Coverage to Codecov
      uses: codecov/codecov-action@v3
  docs:
    runs-on: ubuntu-20.04
    steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-python@v4
      with:
        python-version: '3.10'
      # You can test your matrix by printing the current Python version
    - name: Upgrade pip, install package, install requirements, build docs
      run: |
        pip install --upgrade pip
        pip install .
        pip install -r ./docs/requirements.txt
        pip install sphinx
        sphinx-build docs ./docs/_build/html/
    - uses: actions/upload-artifact@v1
      with:
        name: DocumentationHTML
        path: docs/_build/html/
    - uses: JamesIves/github-pages-deploy-action@v4
      with:
        folder: docs/_build/html/ # The folder the action should deploy.